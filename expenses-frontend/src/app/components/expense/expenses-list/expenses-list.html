<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>📊 Мої витрати</h3>
    <button class="btn btn-success btn-rounded px-3 py-2" (click)="openCreate()">
      ➕ Додати
    </button>
  </div>

  @if (loading) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary"></div>
    </div>
  } @else if (errorMessage) {
    <div class="alert alert-danger">{{ errorMessage }}</div>
  } @else if (expenses.length) {
    <div class="table-responsive shadow-sm rounded">
      <table class="table custom-table align-middle">
        <thead>
          <tr>
            <th>📅 Дата</th>
            <th>📂 Категорія</th>
            <th>📝 Опис</th>
            <th class="text-end">💰 Сума</th>
            <th class="text-center">⚙️ Дії</th>
          </tr>
        </thead>
        <tbody>
          @for (e of expenses; track e.id) {
            <tr>
              <td>{{ e.date | date:'dd MMM yyyy' }}</td>
              <td>
                <span class="badge category-badge" [ngClass]="getCategoryClass(e.category)">
                  {{ getCategoryEmoji(e.category) }} {{ e.category }}
                </span>
              </td>
              <td>{{ e.description }}</td>
              <td class="text-end fw-bold">{{ e.amount | currency:'UAH':'symbol':'1.2-2' }}</td>
              <td class="text-center">
                <button class="btn btn-sm btn-primary btn-action me-2"
                        (click)="openEdit(e)" title="Редагувати">
                  ✏️
                </button>
                <button class="btn btn-sm btn-danger btn-action"
                        (click)="confirmDelete(e)" title="Видалити">
                  🗑️
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  } @else {
    <div class="alert alert-info">ℹ️ Витрат поки що немає.</div>
  }

  <app-expense-form-modal
    [visible]="modalVisible"
    [expense]="editingExpense"
    (close)="onCloseModal()"
    (save)="saveExpense($event)">
  </app-expense-form-modal>
</div>
